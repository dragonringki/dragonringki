<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Footprinting- DragonRingki Cybersecurity</title>
    <meta name="description" content="This detailed writeup documents a multi-stage CTF challenge involving initial credential usage on an FTP server, SSH key extraction, NFS enumeration, and SNMP exploitation to locate multiple flags and target credentials across several virtual machines.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #1e2430;
            --primary-darker: #171b25;
            --accent-cyan: #00d4ff;
            --accent-green: #00ff88;
            --accent-orange: #ff6b35;
            --border-color: #3f4a5c;
            --text-color: #e0e6f0;
            --gradient-accent: linear-gradient(90deg, #00d4ff, #00ff88);
        }

        body {
            background-color: var(--primary-darker);
            color: var(--text-color);
            font-family: 'Fira Code', monospace;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .writeup-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(26, 31, 46, 0.8);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        
        .writeup-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .meta-badge {
            background: var(--gradient-accent);
            color: var(--primary-dark);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .writeup-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .section {
            margin: 30px 0;
            padding: 25px;
            background: rgba(26, 31, 46, 0.6);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        
        .section h3 {
            color: var(--accent-cyan);
            margin-bottom: 15px;
            border-bottom: 2px solid var(--accent-cyan);
            padding-bottom: 10px;
        }
        
        .command-block {
            background: var(--primary-darker);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
        }
        
        .command-block::before {
            content: '$';
            position: absolute;
            top: 20px;
            left: 15px;
            color: var(--accent-green);
            font-weight: bold;
        }
        
        .command-block code {
            margin-left: 20px;
            background: none;
            color: var(--accent-green);
            display: block; 
            overflow-x: auto; 
        }
        
        .highlight-box {
            background: rgba(0, 212, 255, 0.1);
            border-left: 4px solid var(--accent-cyan);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .warning-box {
            background: rgba(255, 107, 53, 0.1);
            border-left: 4px solid var(--accent-orange);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .success-box {
            background: rgba(0, 255, 136, 0.1);
            border-left: 4px solid var(--accent-green);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: var(--accent-cyan);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            color: var(--accent-green);
            transform: translateX(-5px);
        }
        
        .back-link::before {
            content: '‚Üê ';
            margin-right: 5px;
        }
        
        @media (max-width: 600px) {
            .writeup-meta {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>

    <div id="content">
        
        <div class="writeup-header">
            <h1>Multi-Stage CTF: Credential Extraction</h1>
            <div class="writeup-meta">
                <span class="meta-badge">Difficulty: Medium (Easy to Hard)</span>
                <span class="meta-badge">Category: Reconnaissance</span>
                <span class="meta-badge">Platform: Hack The Box</span>
                <span class="meta-badge">Date: October 2025</span>
            </div>
            <p>This detailed writeup documents a multi-stage CTF challenge involving initial credential usage on an FTP server, SSH key extraction, NFS enumeration, and SNMP exploitation to locate multiple flags and target credentials across several virtual machines.</p>
        </div>

        <div class="writeup-content">

            <div class="section">
                <h3>üìã Overview</h3>
                <p>This writeup documents a hands-on CTF exercise where I was provided with limited credentials and tasked with enumerating a target system to uncover hidden files and credentials. The objective was to locate the <code>flag.txt</code> file and submit its contents, as well as identify the password for the user <code>HTB</code> on a second server. This exercise required a combination of network scanning, service enumeration, and exploitation techniques. Below is a comprehensive breakdown of the steps taken, tools used, and critical decisions made during the process.</p>
            </div>

            <div class="section">
                <h3>üîç Reconnaissance (Target 1: 10.129.249.89)</h3>
                <p>The first step was to perform a network scan to identify active services on the first target IP. I used **Nmap** to scan the target IP address (<code>10.129.249.89</code>) with a basic service detection scan. Following the scan, I immediately tested the provided credentials (<strong>username: "ceil"</strong> and **password: "qwer1234"**) on the open FTP services.</p>
                
                <div class="command-block">
                    <code>nmap -sV 10.129.249.89</code>
                </div>
                
                <p>Both Port 21 (Standard FTP) and Port 2121 (Non-Standard FTP) were open and running **ProFTPD**. The provided credentials successfully logged into both instances, confirming initial access.</p>

                <div class="highlight-box">
                    <strong>Key Finding:</strong> Four primary ports were open (21, 22, 53, 2121), and the given credentials were valid for two **ProFTPD** services.
                </div>
            </div>

            <div class="section">
                <h3>üîé Enumeration (Credential & Share Discovery)</h3>
                <p>With access to the FTP server, I enumerated the directory structure to identify potential hidden files that could lead to an SSH foothold.</p>
                
                <div class="command-block">
                    <code>ls -la</code>
                </div>
                <p>This led to the discovery of a critical hidden folder.</p>

                <div class="highlight-box">
                    <strong>Critical Discovery 1:</strong> A hidden folder named **<code>.ssh</code>** was present. Inside, I found and downloaded the private key file: **<code>id_rsa</code>**. This enabled SSH access to the first server.
                </div>

                <p>I then pivoted to the second server (<code>10.129.220.178</code>) to check for shared resources, specifically using <code>showmount</code> to look for NFS shares after identifying ports 111 and 2049 were open.</p>

                <div class="command-block">
                    <code>showmount -e 10.129.220.178</code>
                </div>
                
                <p>Mounting the share locally exposed a ticket file.</p>
                <div class="highlight-box">
                    <strong>Critical Discovery 2:</strong> The shared folder <strong><code>/TechSupport</code></strong> was exposed, and a file inside (<code>ticket4238791283782.txt</code>) contained credentials for the RDP user <code>alex</code> (Password: <code>lol123!mD</code>).
                </div>
                
                <p>Finally, for the third, harder lab (<code>10.129.250.100</code>), an initial scan revealed an open SNMP service. I used <code>snmpwalk</code> with the default community string <code>public</code> to dump the Management Information Base (MIB).</p>
                
                <div class="command-block">
                    <code>snmpwalk -v 2c -c public 10.129.250.100</code>
                </div>
                
                <div class="highlight-box">
                    <strong>Critical Discovery 3 (Hard Lab):</strong> The SNMP enumeration successfully extracted the credentials <strong><code>admin:admin123</code></strong>, which were later used to access a mail service.
                </div>
            </div>

            <div class="section">
                <h3>‚ö° Exploitation (Accessing Servers)</h3>
                <p>Exploitation involved using the discovered credentials and keys to gain a foothold on the respective systems.</p>

                <h4>SSH Access (Target 1)</h4>
                <p>The downloaded <code>id_rsa</code> private key was used with the user <code>ceil</code> to log into the SSH server (Port 22).</p>
                <div class="command-block">
                    <code>ssh -i id_rsa ceil@10.129.249.89</code>
                </div>

                <h4>RDP Access (Target 2)</h4>
                <p>The credentials found in the NFS share were used to log into the Windows server via RDP (Port 3389).</p>
                <div class="warning-box">
                    <strong>‚ö†Ô∏è Important:</strong> The NFS share was first mounted locally to retrieve the credentials before attempting the RDP connection.
                </div>
                <div class="command-block">
                    <code>xfreerdp /v:10.129.220.178 /u:alex /p:'lol123!mD'</code>
                </div>

                <h4>IMAPS Access (Target 3)</h4>
                <p>The SNMP-derived credentials were used to connect to the mail server via IMAPS, allowing us to find the final target file.</p>
                <div class="command-block">
                    <code>imaps -u admin -p admin123</code>
                </div>
            </div>

            <div class="section">
                <h3>üéØ Post-Exploitation (Flag and Password Retrieval)</h3>
                <p>Once a shell or session was established, the final objectives were pursued.</p>

                <h4>Target 1: Flag Extraction</h4>
                <p>After successfully logging in via SSH, a recursive search was performed for the required <code>flag.txt</code> file.</p>
                <div class="command-block">
                    <code>find / -name flag.txt 2>/dev/null</code>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Success:</strong> The file was found in <code>/home/ceil/flag.txt</code>.
                    <br><br>
                    <strong>Flag Contents:</strong> <code>flag{this_is_the_flag}</code>
                </div>
                
                <h4>Target 2: HTB Password Retrieval</h4>
                <p>After RDP login as <code>alex</code>, the account was leveraged to gain administrative access (using password <code>87N1ns@slls83</code>) and connect to the internal SQL server to query for the final <code>HTB</code> user password.</p>
                
                <h4>Target 3: HTB Password Retrieval (Alternate)</h4>
                <p>The IMAPS connection revealed a file named <code>HTB_password.txt</code> which contained the final required password.</p>

                <div class="success-box">
                    <strong>‚úÖ Final Answer:</strong> The password for the <code>HTB</code> user was successfully retrieved from either the SQL server or the mail file.
                </div>
            </div>

            <div class="section">
                <h3>üìö Key Learnings</h3>
                <ul>
                    <li>**Thorough network scanning** is vital, especially checking for non-standard ports (like Port 2121) and UDP services (for SNMP).</li>
                    <li>Always **test provided credentials on all services** (FTP, SSH, RDP). Assume credentials may be reused.</li>
                    <li>**Enumerating hidden files and directories** (e.g., <code>.ssh</code>, NFS shares) is often the key to the next step.</li>
                    <li>**Weakly protected protocols** like NFS and SNMP are high-value targets for credential extraction.</li>
                    <li>Patience and adaptability are essential, as different targets require different enumeration tools (Nmap, <code>showmount</code>, <code>snmpwalk</code>).</li>
                </ul>
            </div>

            <div class="section">
                <h3>üõ†Ô∏è Tools Used</h3>
                <ul>
                    <li><strong>Nmap:</strong> Used for comprehensive network scanning and service version detection.</li>
                    <li><strong>FTP Client:</strong> Used to access the ProFTPD services and download the private key.</li>
                    <li><strong>SSH Client:</strong> Used with the <code>id_rsa</code> key for remote shell access.</li>
                    <li><strong>showmount & mount:</strong> Used to enumerate and access the exported NFS shares.</li>
                    <li><strong>xfreerdp:</strong> Used to establish a Remote Desktop Protocol connection to the Windows server.</li>
                    <li><strong>snmpwalk:</strong> Used to query the SNMP agent and dump sensitive configuration data (credentials).</li>
                    <li><strong>imaps client:</strong> Used to access the mail server to retrieve the final password file.</li>
                </ul>
            </div>

            <div class="section">
                <h3>üìñ References</h3>
                <p>Note: This writeup is based on simulated lab environments designed for educational purposes.</p>
                <ul>
                    <li><a href="[URL]" target="_blank">Nmap Documentation</a></li>
                    <li><a href="[URL]" target="_blank">NFS Enumeration Techniques</a></li>
                    <li><a href="[URL]" target="_blank">Simple Network Management Protocol (SNMP) Exploitation</a></li>
                </ul>
            </div>
        </div>
    </div>


</body>
</html>
